{
    "contents" : "---\ntitle: \"Research Report 9/2\"\nauthor: \"Mao Hu\"\ndate: \"Tuesday, September 02, 2014\"\noutput: html_document\n---\n\nFirst, I simulated data.\n\n```{r}\nset.seed(373875)\n\nx <- rnorm(100,0,1)\ny <- rbinom(100,1,pnorm(x))\n\nfit <- glm(y ~ 1, data = data.frame(cbind(x,y)), family = binomial())\n\nlogitLikelihood <- function(alpha, y){\n  value = 1\n  for(i in 1:length(y)){\n    value = value * exp(alpha*y[i])/(1+exp(alpha))\n  }\n  value\n}\n\nprobitLikelihood <- function(beta, y){\n  value = 1\n  for(i in 1:length(y)){\n    value = value * pnorm(beta)^(y[i]) * (1-pnorm(beta))^(1-y[i])\n  }\n  value\n}\n\n```\n\n```{r}\nsupport<-seq(-3,3,.01)\n\nlogit <- logitLikelihood(support,y)\nprobit <- probitLikelihood(support,y)\n\n```\n\nLikelihood:\n$$\n\\begin{align}\nL(\\beta) =& \\prod_{i=1}^{n} Pr(y_i=1)^{y_i} [1-Pr(y_i=1)]^{1-y_i}\\\\\nPr(y_i=1) =& \\frac{e^{X'\\beta}}{1+e^{X'\\beta}}\\\\\nPr(y_i=1) =& \\Phi(X'\\beta)\n\\end{align}\n$$\n\nPlot of logistic likelihood and probit likelihoood.\n\n```{r, echo=FALSE}\nplot(support,logit,col=2)\npoints(support,probit,col=3)\npoints(support,probit-logit)\n```\n\n\nPlots of logistic likelihood and transformed probit likelihood.\n\n```{r, echo=FALSE}\nprobit2 <- probitLikelihood(support*0.627,y)\nplot(support,logit,col=2)\npoints(support,probit2,col=3)\npoints(support,probit2-logit)\n```\n\n\nImportance samplers\n\n```{r}\n\nrequire(LearnBayes)\nprobit.model <- bayes.probit(y, X = matrix(1,ncol=1,nrow=100), m=10000)\ncolMeans(probit.model$beta)\n\ncolMeans(probit.model$beta)*4/sqrt(2*pi)\n\ndim(probit.model$beta)\nhist(probit.model$beta[,1])\n\nsummary(fit)\n\n\n#SIMPLE IMPORTANCE SAMPLER\nweights <- logitLikelihood(probit.model$beta, y)/ probitLikelihood(probit.model$beta, y)\nmu_q_1 <- t(probit.model$beta)%*%weights/sum(weights)\nd <- density(weights)\nplot(d)\nprobit.model$beta[which(weights==max(weights))]\n\n\nvar_q_1<-t((weights/sum(weights))^2)%*%(probit.model$beta-mu_q_1[1,1])^2\nmu_q_1\nsqrt(var_q_1[1,1])\n\n#WITH TRANSFORMATION\nweights2 <- logitLikelihood(probit.model$beta*4/sqrt(2*pi), y)/ ( probitLikelihood(probit.model$beta, y)*sqrt(2*pi)/4 )\nhist(weights2)\nmu_q_2<-t(probit.model$beta)%*%weights2/sum(weights2)\nvar_q_2<-t((weights2/sum(weights2))^2)%*%(probit.model$beta-mu_q_2[1,1])^2\nmu_q_2\nsqrt(var_q_2[1,1])\n```",
    "created" : 1409714307906.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "675548393",
    "id" : "DA938C80",
    "lastKnownWriteTime" : 1409715319,
    "path" : "C:/Users/Mao/Dropbox/Senior Year/Research/scripts/report9-2.Rmd",
    "project_path" : null,
    "properties" : {
        "tempName" : "Untitled1"
    },
    "source_on_save" : false,
    "type" : "r_markdown"
}