{
    "contents" : "#################\n# LOAD PACKAGES #\n#################\n\nrequire(mvtnorm) #for sampling from multivariate normal\nrequire(ggplot2) #for plotting\nrequire(BMA) #Adrian Raftery's Bayesian Model Averaging Package\nrequire(magrittr) #for coding semantics\n\nset.seed(10294) #true model\n\n###################################\n# TRUE MODEL FOR eae              #\n# THE IN-CONTEXT ACTOR EVALUATION #\n###################################\n\n\n#Model coefficients\nsim.B = c(-0.3,0.19,0.23,-0.25,rnorm(24,0,.0125),0.25,rnorm(20,0,.0125),-0.25,rnorm(14,0,.025))\n\nqplot(x=1:64,y=sim.B,xlab=\"Index\",ylab=\"Coefficient\",size=5)+theme(text=element_text(size=20),legend.position=\"none\")\n\n############################\n# SIMULATED DATA FROM MODEL#\n############################\n\n#I want the data generated from the true model to have characteristics similar to the duke10 data\nduke10 <- read.csv(\"~/GitHub/affectcontroltheory/Data Merged by Event/duke10_by_event.csv\")\n\ncorrplot(cor(duke10[,c(\"ae\",\"ap\",\"aa\",\"be\",\"bp\",\"ba\",\"oe\",\"op\",\"oa\")]))\n\n#covariate means\nX.mean=matrix(colMeans(duke10[,c(\"ae\",\"ap\",\"aa\",\"be\",\"bp\",\"ba\",\"oe\",\"op\",\"oa\")]))\n#covariate SD\nX.var=var(duke10[,c(\"ae\",\"ap\",\"aa\",\"be\",\"bp\",\"ba\",\"oe\",\"op\",\"oa\")])\n\n#simulated covariates\nsim.X1= rmvnorm(1000,X.mean,X.var)\ncolnames(sim.X1) <- colnames(duke10[,10:18])\n\n# TWO-WAY CROSS WORD INTERACTIONS\nsim.X1.interaction = as.matrix(t(apply(sim.X1,1,combn,2,prod)))\ncolnames(sim.X1.interaction)=paste(combn(names(duke10[,10:18]),2,paste,collapse=\".\"),sep=\"\")\nsim.X1.interaction.2=sim.X1.interaction[,c(-1,-2,-9,-22,-23,-27,-34,-35,-36)]\n\n# THREE WAY CROSS WORD INTERACTIONS\n\n#first, generate all three-way interaction names\nsim.X1.3.names.full=paste(combn(names(duke10[,10:18]),3,paste,collapse=\".\"),sep=\"\")\n\n#for-loop looks through all the interaction names and stores only those which are cross-word interactions\nsim.X1.3.names = matrix(nrow = 84, ncol =2)\nfor (i in 1:length(sim.X1.3.names.full)){\n  interaction=sim.X1.3.names.full[i]\n  words = c(substr(interaction,1,1),substr(interaction,4,4),substr(interaction,7,7))\n  if(!is.na(sum(pmatch(c(\"a\",\"b\",\"o\"),words)))){\n    sim.X1.3.names[i,] <- c(interaction,TRUE)\n    print(interaction)\n  }\n  else{\n    sim.X1.3.names[i,] <- c(\"\",FALSE)\n  }\n}\n\n#then, calculate the interactions and use the names to select which ones to keep\nsim.X1.interaction.3 <- as.matrix(t(apply(sim.X1,1,combn,3,prod)))[,sim.X1.3.names[,2]==\"TRUE\"]\ncolnames(sim.X1.interaction.3)=sim.X1.3.names[which(sim.X1.3.names[,2]==\"TRUE\"),1]\n\n# COMBINE TWO-WAY AND THREE-WAY INTERACTIONS\nsim.X1.design.matrix = (cbind(1,sim.X1,sim.X1.interaction.2,sim.X1.interaction.3))\n\n\n#let the sd of the random error come from a lm on the real data\nmodel.summary <- lm(eae ~. , data = duke10[,c(\"eae\", \"ae\",\"ap\",\"aa\",\"be\",\"bp\",\"ba\",\"oe\",\"op\",\"oa\")]) %>% summary()\nY.sd <- model.summary$sigma\n\n#GENERATE FAKE DATA FROM MODEL\n#here we add intercept\nsim.Y=matrix(rmvnorm(1,sim.X1.design.matrix%*%sim.B,diag(Y.sd^2,1000)),ncol=1)\n\n# COMPARE SIMULATED DATA WITH REAL DATA\nsd(sim.Y)\nsd(duke10$eae)\n\n#minus the intercept\nsim.X1.design.dataframe <- data.frame(sim.X1.design.matrix)\ncorrplot(cor(sim.X1.design.dataframe[,c(\"ae\",\"ap\",\"aa\",\"be\",\"bp\",\"ba\",\"oe\",\"op\",\"oa\")]))\ncorrplot(cor(duke10[,c(\"ae\",\"ap\",\"aa\",\"be\",\"bp\",\"ba\",\"oe\",\"op\",\"oa\")]))\n\n####################\n# CONDUCT ANALYSIS #\n####################\n\nsim.data <- data.frame(cbind(eae=sim.Y,sim.X1.design.matrix))\nselect.training.set <- sample(1:1000,150)\ntrain.data <- sim.data[select.training.set,]\ntest.data <- sim.data[-select.training.set,]\n\n#OLS REGRESSION\nsim.model.ols = lm(V1~.,data=train.data[,-2])\nsummary(sim.model.ols)\n\n#STEPWISE REGRESSION\nsim.model.stepwise = step(sim.model.ols)\nsummary(sim.model.stepwise)\n\n#BAYESIAN MODEL AVERAGING\nsim.model.BMA = bicreg(train.data[,-1],train.data[,1])\nsummary(sim.model.BMA)\n\n#LASSO\n\n\n\n",
    "created" : 1409063535417.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "3616282131",
    "id" : "10504699",
    "lastKnownWriteTime" : 1409078308,
    "path" : "~/GitHub/affectcontroltheory/simulation/simulation.R",
    "project_path" : "simulation.R",
    "properties" : {
        "tempName" : "Untitled1"
    },
    "source_on_save" : false,
    "type" : "r_source"
}