{
    "contents" : "#---------------------------LOAD PACKAGES-------------------------\nrequire(BMA) #Adrian Raftery's Bayesian Model Averaging Package\nrequire(BAS) #Merlise Clyde's Bayesian Model Averaging Package\nrequire(corrplot) #for plotting corrplots\nrequire(mvtnorm)\nrequire(ggplot2)\nset.seed(10294)\nsetwd(\"C:/Users/Mao/Dropbox/Junior Year/Affect Control Research/csv Data/scripts\")\n\n\n#---------------------------CREATE TRUE MODEL--------------------------\nduke10 <- read.csv(\"C:/Users/Mao/Dropbox/Junior Year/Affect Control Research/csv Data/scripts/duke10_by_event.csv\")\n#What are the characteristics of this dataset?\n\nsummary(duke10$eae)\n\n\n#Here we create a hypothetical \"true\" model for impression change\n\n\nsim.B = c(0.5,0.4,-0.5,0.3,rnorm(42,0,.025))\n#sim.B = c(0.5,0.4,-0.5,0.3,rep(0,42))\nhist(sim.B,breaks =20)\nlength(sim.B)\nplot(sim.B)\nqplot(x=1:46,y=sim.B,xlab=\"Index\",ylab=\"Coefficient\")+theme(text=element_text(size=20))\n\n\n\nX.mean=matrix(colMeans(duke10[,10:18]))\nX.sd=apply(duke10[,10:18],2,sd)\nY.sd=0.7*sd(duke10[,1])\n\n\n#simulated covariates\nsim.X1= rmvnorm(150,X.mean,diag(X.sd,nrow=9))\ncolnames(sim.X1) = paste(names(duke10[,10:18]))\nsim.X2 = as.matrix(t(apply(sim.X1, 1, combn, 2, prod)))\ncolnames(sim.X2) = paste(combn(names(duke10[,10:18]), 2, paste, collapse=\":\"), sep=\"\")\nsim.X = cbind(1,sim.X1,sim.X2)\n\n#generate Y from normal with sd from lm of actual data\nsim.Y=matrix(rmvnorm(1,sim.X%*%sim.B,diag(Y.sd,150)),ncol=1)\n\nsd(sim.Y)\nsd(duke10$eae)\n\nsim.data=data.frame(cbind(sim.Y,sim.X))\nnames(sim.data)[1]=\"eae\"\nnames(sim.data)[2]=\"Intercept\"\n\n#naive OLS regression\nsim.model.ols = lm(eae~.,data=sim.data[,-2])\nsummary(sim.model.ols)\nplot(sim.model.ols$coefficients)\n\n\n#stepwise regression\nsim.model.stepwise = step(sim.model.ols)\nsummary(sim.model.stepwise)\n\n#bayesian model averaging\nsim.model.BAS = bas.lm(eae~.,data=sim.data[,-2],n.models=10000)\nsummary(sim.model.BAS)\ncoefs.BAS=coef(sim.model.BAS)\nprint(coefs.BAS)\nplot(coefs.BAS$postmean)\nplot(coefs.BAS$probne0)\nqplot(y=coefs.BAS$probne0,x=1:46,xlab=\"index\",ylab=\"Model inclusion probability\")+theme(text=element_text(size=20))\n\n\n##Bayesian Model averaging\nsim.model.BAM = bicreg(sim.data[,-1],sim.data[,1])\nsummary(sim.model.BAM)\n\n##plot coefficient estimates against each other\nsim.model.stepwise.coefficients = sim.model.stepwise$coefficients\nwhich(names(sim.model.stepwise.coefficients)==names(sim.data))\n        \nindices.stepwise=pmatch(names(sim.model.stepwise.coefficients),names(sim.data[-1]))\nindices.stepwise.2=c(1,indices.stepwise[-1])\n\nstepwise.coefs=data.frame(coefs=sim.model.stepwise.coefficients,index=indices.stepwise.2,method=\"stepwise\")\nstepwise.coefs\n\nBAS.coefs=data.frame(coefs=coefs.BAS$postmean,index=1:46,method=\"BMA\")\nBAS.coefs\n\ntrue.coefs = data.frame(coefs=sim.B,index=1:46,method=\"Simulation\")\ntrue.coefs\n\n\ndatastuff = rbind(stepwise.coefs,BAS.coefs,true.coefs)\n\np <- ggplot(data=datastuff, aes(x=index,y=coefs,colour=method,shape=method,size=5))+geom_point()+theme(text=element_text(size=20))\np\n",
    "created" : 1409073678189.000,
    "dirty" : true,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "440320794",
    "id" : "878FB7A",
    "lastKnownWriteTime" : 1402498578,
    "path" : "C:/Users/Mao/Dropbox/Junior Year/Affect Control Research/csv Data/scripts/simulation2.R",
    "project_path" : null,
    "properties" : {
    },
    "source_on_save" : false,
    "type" : "r_source"
}